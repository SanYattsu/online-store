# Дипломный проект

## Описание проекта

Проект является выпускной работой по курсу **DevOps для эксплуатации и разработки**.

> Исходные данные - репозиторий с исходным кодом для backend’а и frontend’а.

В первой части задания подготовлены Dockerfile'ы, конфигурация Nginx и docker-compose.yaml чтобы можно было локально провериьт раьотоспособность сайта. Во второй, настроен ci-cd пайплайн для gitlab'а. Его этапы: тестирования sast и 
sonarqube, сборка и релиз image'ей в registry Яндекс облака (окончательная отработка была уже после поднятия инфраструктуры).

*Формально можно было использовать gitlab для хранения, но с точки зрения надежности, так как не используется managed решение, то стороннее registry более оптимально*.

В инфраструктурной части при помощи Terraform развернуто две виртуальные машины для kubernetes и gitlab, registry, s3 хранилище для статики сайта и сетевая инфраструктура (сеть, подсеть и ресурсные записи DNS класса A), а так же сервисный аккаунт с необходимыми доступами. Далее при помощи Ansible был поднят Gitlab, настройка ранеров выполнялась в ручную. В завершающей часте написаны helm-чарты для backend’а, frontend’а (папка momo-chart) и мониторинга, включающего в себя стандартный стек Grafana, Prometeus & Alertmanager, Loki & Promtail. С ci-cd пайплайне чарт backend’а и frontend’а пакуется, версионируется и кладется во внешнее хранилище NEXUS. На следующем этапе проводится деплой в k3s.

## Ссылки

> Ссылки оставлены для примера и были актуальны на момент сдачи проекта.

- [Сайт магазина](http://store.practi-testing.fun/)
- [Grafana](http://grafana.practi-testing.fun/)
- [Gitlab](https://gitlab.practi-testing.fun/)

## Чеклист проделанной работы

- [x] Код хранится в GitLab с использованием любого git-flow
- [x] В проекте присутствует .gitlab-ci.yml, в котором описаны шаги сборки
- [x] Артефакты сборки (бинарные файлы, docker-образы или др.) публикуются в систему хранения (Nexus или аналоги)
- [x] Артефакты сборки версионируются
- [x] Написаны Dockerfile'ы для сборки Docker-образов бэкенда и фронтенда 
    - Бэкенд: бинарный файл Go в Docker-образе
    - Фронтенд: HTML-страница раздаётся с Nginx
- [x] В GitLab CI описан шаг сборки и публикации артефактов
- [x] В GitLab CI описан шаг тестирования
- [x] В GitLab CI описан шаг деплоя
- [x] Развёрнут Kubernetes-кластер в облаке
- [x] Kubernetes-кластер описан в виде кода, и код хранится в репозитории GitLab
- [x] Конфигурация всех необходимых ресурсов описана согласно IaC
- [x] Состояние Terraform'а хранится в S3
- [x] Картинки, которые использует сайт, или другие небинарные файлы, необходимые для работы, хранятся в S3
- [x] Секреты не хранятся в открытом виде
- [x] Написаны Kubernetes-манифесты для публикации приложения
- [x] Написан Helm-чарт для публикации приложения
- [x] Helm-чарты публикуются и версионируются в Nexus
- [x] Приложение подключено к системам логирования и мониторинга
- [x] Есть дашборд, в котором можно посмотреть логи и состояние приложения

## Автор

[Игорь Широков](https://github.com/SanYattsu)
